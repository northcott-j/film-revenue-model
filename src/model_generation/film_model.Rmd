---
title: "Film Revenue Model"
output: html_notebook
---
<strong>Business understanding</strong><br>
<a href="http://blog.jdnorthcott.com/2017/11/ready-set-go.html">Project About</a><br><br>

<strong>Data understanding</strong><br>
<a href="http://blog.jdnorthcott.com/2017/11/python-scraper-brain-dump.html">Inital Brain Dump of Python</a><br>
<a href="http://blog.jdnorthcott.com/2017/11/r-brain-dump.html">Initial Brain Dump of R</a><br><br>

<strong>Data preparation</strong><br>
<a href="http://blog.jdnorthcott.com/2017/11/implementing-python-scraper.html">Python Scraping Day One</a><br>
<a href="http://blog.jdnorthcott.com/2017/12/implementing-python-scraper-day-two.html">Python Scraping Day Two</a><br>
<a href="http://blog.jdnorthcott.com/2017/12/implementing-python-scraper-day-three.html">Python Scraping Day Three</a><br><br>
Summary:

<strong>Modeling</strong><br>
Backwards fitting

Evaluation
Fit
Test Methods
Test Results

<strong>Deployment</strong><br>
Save co-efficients in Python script
People can run themselves 

<strong>Loading RMongo and linking to local database</strong>
```{r}
require(RMongo)
mg1 <- mongoDbConnect('ds4100')
dbShowCollections(mg1)
```


<strong>Building the data.frame</strong>
```{r}
films <- dbGetQuery(mg1, 'films_agg', "{'FAILED': false}") 
```

<strong>Map all Distinct MPAA values and create a "dictionary"</strong>
```{r}
# Any non-sense values will be 0
# Go from NC-17 -> G being 1 - n
# Default value to return if string is something random
mpaa.int.default <- 0
mpaa.strings <- c(
    "NC-17",
    "R",
    "PG-13",
    "M/PG",
    "PG",
    "PASSED",
    "G"
)
mpaa.ints <- c(1:7)
# Setting the names of the ints to the corresponding ratings
names(mpaa.ints) <- mpaa.strings
# Test it out
mpaa.ints['R']
```

<strong>Write a function to remap MPAA values to a number</strong>
```{r}
# Takes a string rating and returns an int
mpaa.mapping<-function(rating) {
  if (rating %in% mpaa.strings) {
    return(mpaa.ints[rating])
  } else {
    return(mpaa.int.default)
  }
}

mpaa.mapping('R')   # 2
mpaa.mapping('XXX') # 0
```

<strong>Create new column in data.frame with mpaa ints</strong>
```{r}
string_ratings <- films$mpaa
string_ints <- sapply(string_ratings, mpaa.mapping)
films$mpaa_num <- string_ints
```

<strong>Possible fields to be included in the model. Going to use backwards fitting to design the model<br></strong>
<p>
revenue<br>
|<br>
v<br>
FILM SPECIFIC<br>
weekday<br>
day<br>
month<br>
budget<br>
length<br>
mpaa_num<br>
director_age<br>
avg_actor_age<br>

ACTOR SPECIFIC <br>
max_actor_film_revenue<br>
avg_actor_film_revenue<br>
max_actor_film_votes<br>
avg_actor_film_votes<br>
max_actor_film_stars<br>
avg_actor_film_stars<br>
max_actor_film_appearances<br>
avg_actor_film_appearances<br>
max_actor_film_metascore<br>
avg_actor_film_metascore<br>

DIRECTOR SPECIFIC<br>
director_number_of_films<br>
max_director_film_revenue<br>
avg_director_film_revenue<br>
max_director_film_votes<br>
avg_director_film_votes<br>
max_director_film_stars<br>
avg_director_film_stars<br>
max_director_film_metascore<br>
avg_director_film_metascore<br>
</p>

```{r}

```

<strong>Divide data into training and test</strong>
<strong>Using a random 50/50 and 30/70 split</strong>
```{r}

```

<strong>Building the two test models</strong>
```{r}

```

<strong>Running the tests</strong>
```{r}

```

<strong>Checking % correct of both model tests</strong>
```{r}

```

